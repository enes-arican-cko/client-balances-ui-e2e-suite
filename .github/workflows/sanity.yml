name: Dashboard E2E Playwright Tests
run-name: Dashboard E2E Playwright Tests | ${{ inputs.env == '' && 'qa' || inputs.env}}
on:
    schedule:
      - cron: '0 6 * * 1-5' #scheduled to run on every weekday at 6 AM
    workflow_dispatch:
      inputs:
        env:
          description: 'Env'
          required: true
          default: 'sbox'
          type: choice
          options:
            - 'qa'
            - 'sbox'
jobs:
  sanity-tests:
    timeout-minutes: 60
    runs-on: ubuntu-latest
    steps:
        - name: ‚¨áÔ∏è Checkout repository
          uses: actions/checkout@v4

        - name: ‚öôÔ∏è Setup node
          uses: actions/setup-node@v3
          with:
            node-version: 18

        - name: ‚öôÔ∏è Install dependencies
          run: |
            echo "::group::npm install"
            npm ci
            echo "::endgroup::"

        - name: ‚öôÔ∏è Install Playwright Browsers
          run: npx playwright install chromium --with-deps

        - name: üöÄ Run Playwright tests
          run: TEST_ENV=${{ inputs.env == '' && 'sbox' || inputs.env}} npm run test && npm run show-report

        - name: ‚¨ÜÔ∏è Uploading artifact
          uses: actions/upload-artifact@v3
          if: always()
          with:
            name: playwright-report
            path: playwright-report/
            retention-days: 30